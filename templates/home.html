{% extends 'base.html' %}
{% load pygmentify_tags %}
{% load custom_tags %}

{% block page_type %}home{% endblock %}

{% block lang %}{{ blog.lang }}{% endblock %}

{% block favicon %}{% include 'snippets/favicon.html' with blog=blog %}{% endblock %}

{% block title %}{{ blog.title }}{% endblock %}

{% block canonical %}<link rel="canonical" href="{{ blog.useful_domain }}">{% endblock %}

{% block seo %}
{% if not blog.reviewed %}<meta name="robots" content="noindex, nofollow">{% endif %}

<meta name="{{ blog.subdomain }}" content="look-for-the-bear-necessities">

{% include 'snippets/seo_tags.html' with site_name=blog.title title=blog.title type="website" url=blog.useful_domain description=meta_description image=blog.meta_image meta_tag=blog.meta_tag %}
<link rel="alternate" type="application/atom+xml" href="/feed/" title="{{ blog.title }}">
<link rel="alternate" type="application/rss+xml" href="/feed/?type=rss" title="{{ blog.title }}">
{% endblock %}

{% block imports %}

{% if blog.user.settings.upgraded %}{{ blog.header_directive | safe }}{% endif %}

{% if blog.fathom_site_id %}<script src="https://cdn.usefathom.com/script.js" data-site="{{ blog.fathom_site_id }}" defer></script>{% endif %}
{% if blog.contains_code %}<link rel="stylesheet" href="{% pygmentify_css minify='false' %}">{% endif %}
{% endblock %}

{% block custom_styles %}{% include 'snippets/styles.html' with blog=blog %}{% endblock %}

{% block heading %}{{ blog.title }}{% endblock %}

{% block nav %}{% markdown content=blog.nav blog=blog post=None tz=tz %}{% endblock %}

{% block content %}

{% if blog.content %}
{% markdown content=blog.content blog=blog post=None tz=tz %}

{% else %}
{% include "snippets/post_list.html" %}
{% endif %}

{% if posts.empty %}
<p>
    No posts yet
</p>
{% endif %}

{% if blog.analytics_active %}
    <script>
    window.addEventListener("load", () => {
        if (navigator.webdriver !== true) {
            const sendHit = score => {
                const params = new URLSearchParams({
                    blog: "{{ blog.subdomain }}",
                    token: "/",
                    referrer: document.referrer.includes("{{ blog.blank_useful_domain }}") ? "" : document.referrer,
                    title: "",
                    score: score
                });
                new Image().src = `/hit/?${params.toString()}`;
            };

            document.addEventListener('touchmove', () => sendHit(100), { once: true });
            document.addEventListener('mousemove', () => sendHit(100), { once: true });
        }
    });
    </script>
{% endif %}

{% endblock %}

{% block footer %}
{% if blog.user.settings.upgraded and blog.footer_directive %}
<span id="footer-directive">
    {% markdown content=blog.footer_directive blog=blog post=None tz=tz %}
</span>
{% endif %}
<span>
    Powered by <a href="https://bearblog.dev">Bear <span role="img" class="bear" aria-label="ASCII bear logo">ʕ•ᴥ•ʔ</span></a>
</span>
{% endblock %}